---
layout: post
title: "[Thực Hành] Bài 12 Cây quyết định - Decision Tree"
subtitle: "Loạt bài học thuộc series AML"
date: 2021-01-20
author: "KyoHB"
header-img: "img/post-bg-aml.jpg"
tags: [AML]
---

Tiếp nối bài số 11 lý thuyết về cây quyết định - Decision tree, trong bài học này chúng ta sẽ thực hành huấn luyện (training) một Decision tree model cho bài toán phân loại (classication) dữ liệu nhé.


# **Import tập dữ liệu**

Trong bài học này chúng ta sẽ tiếp tục sử dụng tập dữ liệu (dataset) về người trưởng thành đã được sử dụng trong các bài thực hành trước. Dataset này được trải qua tiền xử lý (pre-processing) ở bài 4 và sẵn sàng cho việc huấn luyện (training) các ML model. Việc tái sử dụng tập dữ liệu này nhằm mục đích so sánh hiệu năng của các ML model và nhận xét về những sự khác biệt. 


```python
import pandas as pd
```


```python
df = pd.read_csv('/content/new_adult_data.csv')
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>65</th>
      <th>66</th>
      <th>67</th>
      <th>68</th>
      <th>69</th>
      <th>70</th>
      <th>71</th>
      <th>72</th>
      <th>73</th>
      <th>74</th>
      <th>75</th>
      <th>76</th>
      <th>77</th>
      <th>78</th>
      <th>79</th>
      <th>80</th>
      <th>81</th>
      <th>82</th>
      <th>83</th>
      <th>84</th>
      <th>85</th>
      <th>86</th>
      <th>87</th>
      <th>88</th>
      <th>89</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
      <th>100</th>
      <th>101</th>
      <th>102</th>
      <th>103</th>
      <th>104</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000503</td>
      <td>0.999607</td>
      <td>0.000168</td>
      <td>0.028035</td>
      <td>0.0</td>
      <td>0.000516</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000600</td>
      <td>1.000000</td>
      <td>0.000156</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000156</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000176</td>
      <td>1.000000</td>
      <td>0.000042</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000185</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000226</td>
      <td>1.000000</td>
      <td>0.000030</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000170</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000083</td>
      <td>1.000000</td>
      <td>0.000038</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000118</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45303</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000272</td>
      <td>1.000000</td>
      <td>0.000083</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000256</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>45304</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000240</td>
      <td>1.000000</td>
      <td>0.000063</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000226</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>45305</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000794</td>
      <td>0.999999</td>
      <td>0.000178</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000690</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>45306</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000191</td>
      <td>1.000000</td>
      <td>0.000065</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000198</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>45307</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000231</td>
      <td>1.000000</td>
      <td>0.000057</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000266</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>45308 rows × 105 columns</p>
</div>



# **Phân chia tập dữ liệu**

Tách biến không phụ thuộc (independent variable) và biến phụ thuộc (dependent variable) từ tập dữ liệu (dataset)


```python
x = df.iloc[:,0:104]
y = df.iloc[:,104]
```

Tiếp theo chúng ta sẽ phân chia tập dữ liệu thành hai tập nhỏ hơn: tập dữ liệu huấn luyện (training set) và tập dữ liệu xác nhận (validation set) với tỷ lệ 80% và 20%.

<span style='color: #f44336'>* random_state nhằm đảm bảo việc phân chia dữ liệu là như nhau trong mọi lần chạy.</span>


```python
from sklearn.model_selection import train_test_split
```


```python
X_train, X_valid, Y_train, Y_valid = train_test_split(x, y, test_size = 0.2, random_state = 101)
```

# **Hyperparameter tuning**

Trong bài 3 chúng ta có nhắc đến phương pháp Hyperparameter tuning nhằm giúp cải tiến model. Trong bài thực hành ngày hôm nay chúng ta sẽ áp dụng phương pháp này để tìm ra các thông số vận hành (hyperparameter) của Decision tree model sao cho model của chúng ta đạt hiệu quả (performance) tốt nhất với tập dữ liệu (dataset) đã cho.

Đầu tiên chúng ta sẽ liệt kê các danh sách các hyperparameter và các giá trị để điểu chỉnh. Trong bài thực hành này chúng ta sẽ thực hiện tuning các thông số vận hành (hyperparameter) sau:

1.   criterion: Chỉ sổ để tính độ vấy bẩn (impurity).
2.   max_depth: Độ sâu lớn nhất mà cây có thể phát triển.
3.   min_samples_split: Số cá thể (instance) tối thiểu để phân nhánh một nút (node).
4.   min_samples_leaf: số cá thể (instance) tối thiểu ở lá (leaf). 





```python
list_criterion = ['gini', 'entropy']
list_max_depth = [5, 10, 15, 20, 25, 30]
list_min_samples_split = [2, 4, 6, 8, 10, 12, 14, 16 ,18, 20]
list_min_samples_leaf = [1, 2, 4, 6, 8, 10]
```


```python
tuning_dict = dict(criterion  = list_criterion, 
                    max_depth = list_max_depth, 
                    min_samples_split = list_min_samples_split,
                    min_samples_leaf = list_min_samples_leaf)
```

Bước tiếp theo chúng ta sẽ sử dụng Grid search cross validation để tìm ra giá trị tốt nhất cho từng thông số vận hành (hyperparameter). K-Fold Cross validation là một phương pháp kiểm tra chéo trong đó tập huấn luyện (training set) sẽ được gấp làm k phần, k-1 phần sẽ được sử dụng để huấn luyện và 1 phần sẽ được sử dụng để xác nhận (validation). Model sẽ lần lượt trải qua k lần huấn luyện (training) với tập xác nhận (validation set) thay đổi khác nhau như mô tả ở hình bên dưới với k = 10. Hiệu suất (performance) tổng thể của model trong quá trính huấn luyện (training) ứng với trung bình của k lần huấn luyện (training). Grid search cross validation của thư viện sklearn sẽ thử từng cặp giá trị đã được nêu ở trên và kiểm tra xem các giá trị nào sẽ cho ra model tối ưu nhất.

![image.png](data:image/png;base64,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)


```python
# Khởi tạo Decision tree model
from sklearn.tree import DecisionTreeClassifier
dt_model = DecisionTreeClassifier()
```


```python
from sklearn.model_selection import GridSearchCV
# Khởi tạo grid search cross validation
search = GridSearchCV(dt_model, tuning_dict, verbose=1)
# Fit grid search cross validation với tập huấn luyện
best_hp = search.fit(X_train, Y_train)
```

    Fitting 5 folds for each of 720 candidates, totalling 3600 fits
    

    [Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
    [Parallel(n_jobs=1)]: Done 3600 out of 3600 | elapsed: 22.2min finished
    

Với số lượng khá lớn các giá trị để kiểm tra, phải mất đến hơn 20 phút Grid search cross validation mới thực hiện xong việc tìm kiếm. Giờ chúng ta sẽ xem các giá trị tốt nhất ứng với từng thông số vận hành (hyperparameter) như nào nhé.


```python
best_hp.best_params_
```




    {'criterion': 'gini',
     'max_depth': 25,
     'min_samples_leaf': 10,
     'min_samples_split': 12}



# **Huấn luyện Decision tree model**

**Decision tree model với hyperparameter tuning**

Chúng ta sẽ khởi tạo lại Decision tree model, nhưng với các thông số vận hành (hyperparameter) tương ứng như trên nhé.


```python
# Khởi tạo Decision Tree model với các hyperparameter
dt_model_tuning = DecisionTreeClassifier(criterion='gini', 
                                         max_depth=25, 
                                         min_samples_leaf=10, 
                                         min_samples_split=12)
```


```python
# Fit model với tập huấn luyện
dt_model_tuning.fit(X_train, Y_train)
```




    DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                           max_depth=25, max_features=None, max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=10, min_samples_split=12,
                           min_weight_fraction_leaf=0.0, presort='deprecated',
                           random_state=None, splitter='best')

Chúng ta có thể vẽ Decision tree model vừa huấn luyện (training) xong sử dụng đoạn code sau:

```python
from sklearn import tree
tree.plot_tree(dt_model_tuning) 
```
![]({{ site.baseurl }}/img/in-post/aml/AI_with_Misa_Decision_Tree_34_0.png)

Tuy nhiên có thể thấy do độ phức tạp của dữ liệu cao khiến cho Decision tree model của chúng ta có độ sâu lớn nên hình vẽ không được rõ ràng và cụ thể.

Tiếp theo chúng ta sẽ kiểm tra hiệu năng của Decision tree model trên cả tập huấn luyện (training set) và tập xác nhận (validation set) 


```python
# Độ chính xác (accuracy) trên tập huấn luyện (training set)
dt_model_tuning_score = dt_model_tuning.score(X_train, Y_train)
dt_model_tuning_score
```




    0.891353528665232




```python
# Độ chính xác (accuracy) trên tập xác nhận (validation set)
dt_model_tuning_score_val = dt_model_tuning.score(X_valid, Y_valid)
dt_model_tuning_score_val
```




    0.8562127565658795



Có thể thấy độ chênh lệch giữa độ chính xác (accuracy) trên tập huấn luyện (training set) và tập xác nhận (validation set) là không quá lớn, cho thấy Decision model với hyperparameter tuning vừa được huấn luyện (training) có tính tổng quát (generalization) tốt, không có dấu hiệu quá vừa vặn (overfit).

**Decision tree model mặc định**

Để làm rõ hơn về tính hiệu quả mà hyperparameter tuning đem lại, chúng ta sẽ khởi tạo và huấn luyện (training) một Decision tree model nữa, nhưng model này sử dụng các thông số vận hành (hyperparameter) mặc định để xem sự khác biệt nhé.


```python
# Khởi tạo Decision Tree model mặc định
dt_model = DecisionTreeClassifier()
```


```python
# Fit model với tập huấn luyện
dt_model.fit(X_train, Y_train)
```




    DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                           max_depth=None, max_features=None, max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, presort='deprecated',
                           random_state=None, splitter='best')



Giống như bên trên chúng ta sẽ kiểm tra độ chính xác (accuracy) trên tập huấn luyện (training set) và tập xác nhận (validation set) của Decision tree model mặc định.


```python
# Độ chính xác (accuracy) trên tập huấn luyện (training set)
dt_model_score = dt_model.score(X_train, Y_train)
dt_model_score
```




    0.9999448214975446




```python
# Độ chính xác (accuracy) trên tập xác nhận (validation set)
dt_model_score_val = dt_model.score(X_valid, Y_valid)
dt_model_score_val
```




    0.8307216949900684



Qua phần kiểm tra trên, chúng ta thấy độ chính xác (accuracy) của Decision tree model mặc định ở tập huấn luyện (training set) là rất cao 99%, tuy nhiên khi thực hiện dự đoán ở trên tập xác nhận (validation set) độ chính xác tụt xuống thấp hơn hẳn 83.1%, cho thấy model có dấu hiệu quá vừa vặn (overfit). Độ chính xác (accuracy) của Decision tree model mặc định trên tập xác nhận (validation set) cũng thấp hơn so với Decision tree model với hyperparameter tuning (83.1% và 85.6% tương ứng) dù Decision tree model với hyperparameter tuning có độ chính xác trên tập huấn luyện (training set) thấp hơn. Điều này chứng tỏ mức độ tổng quát (generalization) của model với hyperparameter tuning tốt hơn so với model mặc định. 

Việc sử dụng hyperparameter tuning rõ ràng đã giúp model của chúng ta hiệu quả hơn so với việc sử dụng model mặc định, việc thay đổi các thông số vận hành (hyperparameter) đã giúp cho model có thể dừng việc quy nap (induction) sớm ngăn tình trạng quá vừa vặn (overfit) xảy ra, cải thiện độ tổng quát (generalization) vừa giúp tối ưu hiệu năng (performance) của model.

# **Kiểm tra Decision model đã huấn luyện**

Chúng ta sẽ kiểm thử Decision tree model với hyperparameter tuning trên tập kiểm thử (test set) để đánh giá kỹ hơn hiệu năng (performance) của model nhé.


```python
# Import dữ liệu từ tập kiểm thử (test set)
df_test = pd.read_csv('/content/new_adult_test.csv')
df_test
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>65</th>
      <th>66</th>
      <th>67</th>
      <th>68</th>
      <th>69</th>
      <th>70</th>
      <th>71</th>
      <th>72</th>
      <th>73</th>
      <th>74</th>
      <th>75</th>
      <th>76</th>
      <th>77</th>
      <th>78</th>
      <th>79</th>
      <th>80</th>
      <th>81</th>
      <th>82</th>
      <th>83</th>
      <th>84</th>
      <th>85</th>
      <th>86</th>
      <th>87</th>
      <th>88</th>
      <th>89</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
      <th>100</th>
      <th>101</th>
      <th>102</th>
      <th>103</th>
      <th>104</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000110</td>
      <td>1.000000</td>
      <td>0.000031</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000176</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000423</td>
      <td>1.000000</td>
      <td>0.000100</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000557</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000083</td>
      <td>1.000000</td>
      <td>0.000036</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000119</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000274</td>
      <td>0.998852</td>
      <td>0.000062</td>
      <td>0.047898</td>
      <td>0.0</td>
      <td>0.000249</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000171</td>
      <td>1.000000</td>
      <td>0.000030</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000151</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15055</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000135</td>
      <td>1.000000</td>
      <td>0.000053</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000163</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15056</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000181</td>
      <td>1.000000</td>
      <td>0.000060</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000167</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15057</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000101</td>
      <td>1.000000</td>
      <td>0.000035</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000133</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15058</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000523</td>
      <td>0.997892</td>
      <td>0.000155</td>
      <td>0.064888</td>
      <td>0.0</td>
      <td>0.000476</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15059</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000192</td>
      <td>1.000000</td>
      <td>0.000071</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000329</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>15060 rows × 105 columns</p>
</div>




```python
# Tách biến không phụ thuộc (indepedent variable)
x_test = df_test.iloc[:, 0:104]
# Tách biến phụ thuộc (depedent variable)
y_test = df_test.iloc[:,104]
```


```python
# Thực hiện phân loại dữ liệu trên tập kiểm thử (test set)
y_pred = dt_model_tuning.predict(x_test)
```

Chúng ta sẽ lần lượt kiểm tra các chỉ số độ chính xác (accuracy), độ bao phủ (recall / sensitivity), độ chuẩn xác (precision), ma trận nhầm lẫn (confusion matrix) dự đoán của Decision tree model với hyperparameter tuning trên tập kiểm thử (test set).


```python
from sklearn.metrics import confusion_matrix, accuracy_score, classification_report
```


```python
# Kiểm tra độ chính xác (accuracy)
accuracy_score(y_test, y_pred)
```




    0.799800796812749




```python
import seaborn as sns
import matplotlib.pyplot as plt

def draw_cf_matrix(label, pred):
  cf_matrix = confusion_matrix(label, pred)
  ax = plt.subplot()
  sns.heatmap(cf_matrix, annot=True, ax = ax, fmt='g', cmap='Greens')
  ax.set_xlabel('Predicted labels')
  ax.set_ylabel('True labels')
  ax.set_title('Confusion Matrix')
  ax.xaxis.set_ticklabels([0, 1])
  ax.yaxis.set_ticklabels([0, 1])
  cf_matrix
```


```python
# Vẽ ma trận nhầm lẫn
draw_cf_matrix(y_test, y_pred)
```


![]({{ site.baseurl }}/img/in-post/aml/AI_with_Misa_Decision_Tree_46_0.png)



```python
# In báo cáo phân loại
print(classification_report(y_test, y_pred))
```

                  precision    recall  f1-score   support
    
             0.0       0.89      0.84      0.86     11360
             1.0       0.58      0.69      0.63      3700
    
        accuracy                           0.80     15060
       macro avg       0.73      0.76      0.75     15060
    weighted avg       0.81      0.80      0.81     15060
    
    

So sánh với các kết quả phân loại với kết quả của Logistic Regression model và Naive Bayes model đã được huấn luyện (training) ở bài thực hành số 8 và số 10:

|                     | Accuracy | Recall | Precision | F1-Score |
|---------------------|----------|--------|-----------|----------|
| Logistic Regression | 80%      | 76%    | 57%       | 0.65     |
| Naive Bayes         | 77.15%   | 77%    | 52%       | 0.62     |
| Decision tree       | 79.98%   | 69%    | 58%       | 0.63     |

Decision model với hyperparameter tuning có độ chính xác (accuracy) tương đương với Logistic Regression model, nhưng độ bao phủ (recall) lại thấp hơn hẳn so với các model khác. Nhìn vào ma trận nhầm lẫn (confusion matrix) thì có thể thấy model đã dự đoán sai khá nhiều các cá thể (instance) thuộc nhóm (class) 1. Điểm sáng của model đó là có độ chuẩn xác (precision) tốt nhất 58%, do có ít các cá thể (instance) thuộc nhóm (class) 0 bị dự đoán sai hơn so với các model trước đó. 
